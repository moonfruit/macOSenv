#!/bin/bash

if echo "$1" | grep -Exq '[0-9]+|http:.*|gingkoo'; then
	if [[ "$1" == gingkoo ]]; then
		port=http://10.1.2.12:8118
	else
		port="$1"
	fi
	shift

else
	port=9900
fi

if [[ $port == 1080 || $port == 98[0-9][0-9] ]]; then
	exec proxychains4 -q "$@"
fi

if [[ $port == http:* ]]; then
	export http_proxy="$port"
	export https_proxy="$http_proxy"

elif [[ $port == 99[0-8][0-9] ]]; then
	export http_proxy="http://dkmoonfruit:QAZwsxEDC@127.0.0.1:$port"
	export https_proxy="$http_proxy"

else
	export http_proxy="http://127.0.0.1:$port"
	export https_proxy="$http_proxy"
fi

if [[ -z "$no_proxy" ]]; then
	printf -v no_proxy '%s,' 10.1.2.{1..255}
	export no_proxy="localhost,127.0.0.1,${no_proxy}192.168.1.1,192.168.7.1"
fi

exec "$@"
