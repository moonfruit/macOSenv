#!/usr/bin/env bash
shopt -s extglob

NAME="${0##*/}"
if [[ $NAME =~ -*([0-9]+)(\..+)?$ ]]; then
	CMD=${NAME:0:-${#BASH_REMATCH[0]}}${BASH_REMATCH[2]}
	VERSION=${BASH_REMATCH[1]}
else
	echo "Invalid command name: $NAME" >&2
	exit 1
fi

if [[ $VERSION = 11 ]]; then
	if java-home -v 11 -n graalvm >/dev/null 2>&1; then
		exec java-home -v 11 -n graalvm -- "$CMD" "$@"
	fi
fi
exec java-home -v "$VERSION" -- "$CMD" "$@"
